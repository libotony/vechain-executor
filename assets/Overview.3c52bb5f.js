import{e as L,_ as M}from"./TxModal.50688bb3.js";import{a as D,P as i,g as N,L as q,A as w,E as _,B as G,b as O,c as $,d as j,e as F,_ as x,f as l,h as k,i as C,j as z}from"./index.03e14050.js";import{d as T,i as B,r as m,c as V,n as W,B as b,a as P}from"./index.0d60b973.js";const H=T({__name:"Overview",setup(S){const t=B("$thor"),e=B("$vendor"),a=m(!1),s=m({BaseGasPrice:"-",RewardRatio:"-",ProposerEndorsement:"-",MaxBlockPropers:"-"}),o=m([]),p=m([]),d={get:new D.Function(i.methods.get)},h=async()=>{a.value=!0,await Promise.all([(async()=>{const n=await t.explain([{to:i.address,value:0,data:d.get.encode(i.keys.baseGasPrice)},{to:i.address,value:0,data:d.get.encode(i.keys.rewardRatio)},{to:i.address,value:0,data:d.get.encode(i.keys.proposerEndorsement)},{to:i.address,value:0,data:d.get.encode(i.keys.maxBlockPropers)}]).cache([i.address]).execute();let r=d.get.decode(n[0].data);const c=parseInt(r[0]).toLocaleString()+" WEI";r=d.get.decode(n[1].data);const g=(parseInt(r[0])/1e18).toString();r=d.get.decode(n[2].data);const I=(BigInt(r[0])/BigInt(1e18)).toLocaleString()+" VET";r=d.get.decode(n[3].data);const y=parseInt(r[0]);s.value.BaseGasPrice=c,s.value.RewardRatio=g,s.value.ProposerEndorsement=I,y!==0?s.value.MaxBlockPropers=y.toString():s.value.MaxBlockPropers="101"})(),(async()=>{o.value=await N(t)})(),(async()=>{p.value=await q(t)})()]),a.value=!1},R=V(()=>{if(p.value.length){let n=0;for(let r of p.value)r.active&&r.endorsed&&n++;return n}else return-1}),f=m(!1),u=m({error:"",txid:""});let v={};const A=async n=>{const r=v={};u.value.error="",u.value.txid="",f.value||(f.value=!0);try{const c=t.account(w.address).method(w.methods.revoke).asClause(n),g=await e.sign("tx",[t.account(_.address).method(_.methods.propose).asClause(c.to,c.data)]).request();r===v&&(u.value.txid=g.txid)}catch(c){r===v&&(u.value.error=c.message)}},E=async n=>{const r=v={};u.value.error="",u.value.txid="",f.value||(f.value=!0);try{const c=t.account(_.address).method(_.methods.revokeApprover).asClause(n),g=await e.sign("tx",[t.account(_.address).method(_.methods.propose).asClause(c.to,c.data)]).request();r===v&&(u.value.txid=g.txid)}catch(c){r===v&&(u.value.error=c.message)}};return h().catch(),{__sfc:!0,thor:t,vendor:e,loading:a,paramsData:s,approvers:o,masternodes:p,params:d,loadData:h,activeNodes:R,showModal:f,txReq:u,session:v,revokeMaster:A,revokeApprover:E,explorer:L}}});var J=function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e(b,{staticClass:"w-75 mx-auto"},[e(b,{staticClass:"mt-4"},[e(G,{attrs:{show:a.loading}},[e(O,{attrs:{"no-body":""},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"d-flex justify-content-between"},[e("h4",{staticClass:"my-auto"},[t._v("Overview")]),e("span",[e($,{attrs:{variant:"primary",pill:""},on:{click:a.loadData}},[e(j)],1)],1)])]},proxy:!0}])},[e(F,{attrs:{flush:""}},[t._l(a.paramsData,function(s,o){return e(x,{key:o,scopedSlots:t._u([{key:"content",fn:function(){return[e(l,{attrs:{lg:"6"}},[e(k,[e(l,{attrs:{lg:"8","offset-lg":"4"}},[e("strong",[t._v(t._s(o)+":")])])],1)],1),e(l,{attrs:{lg:"6"}},[e(k,[e(l,{staticClass:"text-monospace text-truncate"},[t._v(t._s(s))])],1)],1)]},proxy:!0}],null,!0)})}),e(C,{staticClass:"title-with-bg py-3 px-4"},[e("div",[e("h4",{staticClass:"my-auto"},[t._v("Steering Committee")])])]),t._l(a.approvers,function(s,o){return e(x,{key:"c"+o,scopedSlots:t._u([{key:"content",fn:function(){return[e(l,{attrs:{lg:"2"}},[e("strong",[t._v("#"+t._s(o+1))])]),e(l,{staticClass:"text-truncate",attrs:{lg:"7"}},[e("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-monospace text-truncate",attrs:{href:a.explorer.account(s.address),title:"identity "+s.identity,target:"_blank"}},[t._v(t._s(s.address))])]),e(l,{attrs:{lg:"1",sm:"2"}},[e(P,{on:{click:function(p){return a.revokeApprover(s.address)}}},[t._v("DEL")])],1)]},proxy:!0}],null,!0)})}),e(C,{staticClass:"title-with-bg py-3 px-4"},[e("div",[e("h4",{staticClass:"my-auto d-inline"},[t._v("Authority")]),e("sup",{staticClass:"d-inline text-secondary"},[t._v(t._s(a.activeNodes!==-1?" "+a.activeNodes:""))])])]),t._l(a.masternodes,function(s,o){return e(x,{key:o,scopedSlots:t._u([{key:"content",fn:function(){return[e(l,{attrs:{lg:"2"}},[e("strong",[t._v("#"+t._s(o+1))])]),e(l,{staticClass:"text-truncate",attrs:{lg:"7"}},[e("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-monospace",attrs:{href:a.explorer.account(s.master),title:"identity: "+s.identity,target:"_blank"}},[t._v(t._s(s.master))])]),e(l,{attrs:{lg:"1",sm:"1"}},[e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:s.active&&s.endorsed?"":s.endorsed?"invalid endorsement":"offline"}},[e(z,{attrs:{variant:s.active&&s.endorsed?"success":"danger"}})],1)]),e(l,{attrs:{lg:"1",sm:"2"}},[e(P,{on:{click:function(p){return a.revokeMaster(s.master)}}},[t._v("DEL")])],1)]},proxy:!0}],null,!0)})})],2)],1)],1)],1),e(M,{attrs:{txid:a.txReq.txid,error:a.txReq.error},model:{value:a.showModal,callback:function(s){a.showModal=s},expression:"showModal"}})],1)},K=[],Q=W(H,J,K,!1,null,null,null,null);const Z=Q.exports;export{Z as default};
